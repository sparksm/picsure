!function(a){"use strict";console.log(a),a.picsure=function(b,c){this.$element=a(c),this.options=b,this.num=Math.round(1e20*Math.random()),this.density=+window.devicePixelRatio||1,this.imageSetCss=function(){var a=document.createElement("div");return a.style.backgroundImage="",a.style.backgroundImage="-webkit-image-set(url() 1x)",""!==a.style.backgroundImage?!0:!1}(),this.oneEm=function(){var b=a("<div/>").css({position:"absolute",bottom:-1e3,right:-1e3,border:"none",margin:0,padding:0,width:"1em"}).appendTo(a("body")),c=b.width();return b.remove(),c}(),this.original=this.$element.attr("src"),this.setOptions(),this.set=this.parseParams(),this.options.picture||(this.setPassed(this.tester(this.set)),this.bind())},a.picsure.settings={picture:!1},a.picsure.prototype={bind:function(){var b=this;a(window).on("resize",function(){b.passed=b.tester(b.set),b.setPassed()}),a(document).on("load","img",function(){b.passed=b.tester(b.set),b.setPassed()})},setOptions:function(){this.options=a.extend(!0,{},this.settings,this.options)},setPassed:function(b){var c=this;return 0===b.length?(c.$element.attr("src")!==c.original&&c.$element.attr("src",c.original),void 0):(a.each(b,function(a){c.$element.attr("src")!==b[a]&&c.$element.attr("src",b[a])}),void 0)},parseSrcset:function(b){var c=a.trim(b);if(!c.match(" "))return c;var d=c.split(","),e=[];return a.each(d,function(b){var c="",f=[],g=a.trim(d[b]).split(" ");a.each(g,function(a){if(0===a)return c=g[a],void 0;var b=g[a][g[a].length-1];b.match(/[whx]/)&&f.push({type:b,value:+g[a].slice(0,g[a].length-1),pass:c})}),e.push(f)}),e},parseParams:function(){if(!this.options.picture){var b=a.trim(this.$element.attr("srcset"));return this.parseSrcset(b)}this.$element.addClass("picsure_"+this.num);var c=this,d=this.$element.find("source");a.each(d,function(b){var e=a(d[b]),f=e.attr("media"),g=e.attr("srcset"),h=c.parseSrcset(g,f);"undefined"!=typeof f&&""!==f&&c.parseMedia(f,h)})},parseMedia:function(b){var c=this,d=a.trim(b),e=d.split("and");a.each(e,function(b){var d=a.trim(e[b]),f=a.trim(d.split(":")[0]);-1!==f.indexOf("(")&&(f=f.slice(f.indexOf("(")+1));var g=a.trim(d.split(":")[1]);-1!==g.indexOf(")")&&(g=g.slice(0,g.indexOf(")")));var h=g.match(/(\d.*?)(?!\d)/),i=g.substring(g.indexOf(h[0])+h[0].length,g.length);h=+g.substring(g.indexOf(h[0]),h[0].length);var j=f.split("-")[0]||"max";"em"===i&&(h*=c.oneEm),console.log(j,h)})},tester:function(b){var c=this,d=[];return a.each(b,function(e){var f=!0;a.each(b[e],function(a){var d=b[e][a];c.testCondition(d)||(f=!1)}),f&&d.push(b[e][0].pass)}),d},testCondition:function(b){switch(b.type){case"w":return a(window).width()<b.value?!0:!1;case"h":return a(window).height()<b.value?!0:!1;case"x":return this.density===b.value?!0:!1;default:return!1}}},a.fn.picsure=function(b){if("string"==typeof b){var c=Array.prototype.slice.call(arguments,1);this.each(function(){var d=a.data(this,"picsure");return d?a.isFunction(d[b])?(d[b].apply(d,c),void 0):(a.error('No such method "'+b+'"'),void 0):(a.error('Cannot call "'+b+'" method prior to initialization.'),void 0)})}else this.each(function(){var c=a.data(this,"picsure");c&&c.destroy(),a.data(this,"picsure",new a.picsure(b,this))});return this},a(function(){var b=a("img:not(picture img)"),c=a("picture");b.picsure(),c.picsure({picture:!0})})}(jQuery);